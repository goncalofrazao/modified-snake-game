SEND

ClientConnectionReq client_connect = CLIENT_CONNECTION_REQ__INIT;
client_connect.client_id = &ch;

size_t packed_size = client_connection_req__get_packed_size(&client_connect);
void * buffer = malloc(packed_size);
client_connection_req__pack(&client_connect, buffer);

zmq_msg_t msg;
zmq_msg_init_size(&msg, packed_size);
memcpy(zmq_msg_data(&msg), buffer, packed_size);
zmq_sendmsg(requester, &msg, 0);

zmq_msg_close(&msg);
free(buffer);


RECEIVE

zmq_msg_t msg;
zmq_msg_init(&msg);
zmq_recvmsg(responder, &msg, 0);
ClientConnectionReq *req = client_connection_req__unpack(NULL, zmq_msg_size(&msg), zmq_msg_data(&msg));
zmq_msg_close(&msg);